# Reference Point State 1.0.0 documentation

* Default content type: [application/json](https://www.iana.org/assignments/media-types/application/json)
* Support: [Epiroc Mining Intelligence support](https://www.epiroc.com)
* Email support: [support-SWT@epiroc.com](mailto:support-SWT@epiroc.com)

Unified API for centralized reference point management.

Note that all operations are defined in the perspective of some reference point provider, and stubs are generated in the perspective of a client consumer. Meaning, read "__subscribe on x/y/z__" as in "__reference point backend will subscribe on x/y/z__" and generated stub will be "__I as a client needs to publish to x/y/z__". For details: https://www.asyncapi.com/blog/publish-subscribe-semantics.

##### Specification tags

| Name | Description | Documentation |
|---|---|---|
| External | - | - |


## Table of Contents

* [Servers](#servers)
  * [RabbitMQ-AMQP](#rabbitmq-amqp-server)
  * [RabbitMQ-MQTT](#rabbitmq-mqtt-server)
* [Operations](#operations)
  * [SUB v1.reference-point.cmd.post](#sub-v1reference-pointcmdpost-operation)
  * [SUB v1.reference-point.cmd.put](#sub-v1reference-pointcmdput-operation)
  * [SUB v1.reference-point.cmd.patch](#sub-v1reference-pointcmdpatch-operation)
  * [SUB v1.reference-point.cmd.delete](#sub-v1reference-pointcmddelete-operation)
  * [SUB v1.reference-point.cmd.snapshot](#sub-v1reference-pointcmdsnapshot-operation)
  * [PUB v1.reference-point.event.update](#pub-v1reference-pointeventupdate-operation)
  * [PUB v1.reference-point.response.operation.service.domain](#pub-v1reference-pointresponseoperationservicedomain-operation)
  * [PUB v1.reference-point.response.snapshot.service.domain](#pub-v1reference-pointresponsesnapshotservicedomain-operation)

## Servers

### `RabbitMQ-AMQP` Server

* URL: `amqps://amqp.{domain}`
* Protocol: `amqp 0.9.1`

Mobilaris RabbitMQ Broker

#### URL Variables

| Name | Description | Default value | Allowed values |
|---|---|---|---|
| domain | Domain URL | _None_ | _Any_ |


### `RabbitMQ-MQTT` Server

* URL: `mqtt://mqtt.{domain}`
* Protocol: `mqtt 0.1.0`


#### URL Variables

| Name | Description | Default value | Allowed values |
|---|---|---|---|
| domain | Domain URL | _None_ | _Any_ |


## Operations

### SUB `v1.reference-point.cmd.post` Operation

* Operation ID: `referencePointPostCmdOperation`

Topic for requesting to create a reference point. All type-appropriate reference point fields are relevant, except uuid, which should be generated by the reference point provider. In addition, the created and updated fields are not mandatory. If one is omitted, the other one will be used for both. If both are omitted, the timestamp of the message will be used.

#### `amqp` Channel specific information

| Name | Type | Description | Value | Constraints | Notes |
|---|---|---|---|---|---|
| is | - | - | `"routingKey"` | - | - |
| queue | - | - | - | - | - |
| queue.name | - | - | `"v1.reference-point.cmd.post"` | - | - |
| queue.durable | - | - | `"true"` | - | - |
| queue.exclusive | - | - | `"false"` | - | - |
| queue.autoDelete | - | - | `"false"` | - | - |
| exchange | - | - | - | - | - |
| exchange.name | - | - | `"amq.topic"` | - | - |
| exchange.type | - | - | `"topic"` | - | - |
| exchange.durable | - | - | `"true"` | - | - |
| exchange.autoDelete | - | - | `"false"` | - | - |
| exchange.vhost | - | - | `"/"` | - | - |
| bindingVersion | - | - | `"0.2.0"` | - | - |

#### `mqtt` Operation specific information

| Name | Type | Description | Value | Constraints | Notes |
|---|---|---|---|---|---|
| qos | - | - | `"2"` | - | - |
| retain | - | - | `"false"` | - | - |
| bindingVersion | - | - | `"0.1.0"` | - | - |
| note | - | - | `"When using MQTT with the RabbitMQ broker, the dots in the topic (which separate the levels in AMQP) should be replaced by slashes. E.g. a client using MQTT should publish to v1/reference-point/cmd/post instead of v1.reference-point.cmd.post and subscribe to v1/reference-point/event/update instead of v1.reference-point.event.update. The MQTT plugin for RabbitMQ translates the MQTT format to the AMQP format and vice versa."` | - | - |

#### Message `ReferencePointModifyCmd`

* Content type: [application/json](https://www.iana.org/assignments/media-types/application/json)

##### Payload

| Name | Type | Description | Value | Constraints | Notes |
|---|---|---|---|---|---|
| (root) | - | Request to make changes to a reference point. | - | - | **additional properties are allowed** |
| timestamp | object | Seconds and nanoseconds at UTC since 1970-01-01 00:00:00. | - | - | **required**, **additional properties are NOT allowed** |
| timestamp.seconds | integer | Unix timestamp, which is the number of seconds at UTC since 1970-01-01 00:00:00. Although some implementations may use 32-bit integers to represent this, it is highly recommended that you use a 64-bit integer, since 32 bits will only last for a few more years at the time of writing. | - | [ 0 .. 9223372036854776000 ] | **required** |
| timestamp.nanos | integer | There is no guarantee that all implementations support nanosecond precision. | - | [ 0 .. 999999999 ] | **required** |
| replyTo | string | The topic the result will be published to. | - | - | **required** |
| correlationId | string | ID that will be used in the response to a request to alleviate matching responses to requests on the client side. | - | format (`uuid`) | **required** |
| operand | object | Contains the state of an RP. Not all fields are necessary for all operations. | - | - | **required**, **additional properties are NOT allowed** |
| operand.uuid | string | Unique and immutable. | - | format (`uuid`) | - |
| operand.rpId | string | MAC address or other ID of a device. MACs are formatted as aa:bb.cc:dd:ee:f1. Unique. | - | - | - |
| operand.name | string | - | - | - | - |
| operand.description | string | - | - | - | - |
| operand.createTime | object | Seconds and nanoseconds at UTC since 1970-01-01 00:00:00. | - | - | **additional properties are NOT allowed** |
| operand.createTime.seconds | integer | Unix timestamp, which is the number of seconds at UTC since 1970-01-01 00:00:00. Although some implementations may use 32-bit integers to represent this, it is highly recommended that you use a 64-bit integer, since 32 bits will only last for a few more years at the time of writing. | - | [ 0 .. 9223372036854776000 ] | **required** |
| operand.createTime.nanos | integer | There is no guarantee that all implementations support nanosecond precision. | - | [ 0 .. 999999999 ] | **required** |
| operand.updateTime | object | Seconds and nanoseconds at UTC since 1970-01-01 00:00:00. | - | - | **additional properties are NOT allowed** |
| operand.updateTime.seconds | integer | Unix timestamp, which is the number of seconds at UTC since 1970-01-01 00:00:00. Although some implementations may use 32-bit integers to represent this, it is highly recommended that you use a 64-bit integer, since 32 bits will only last for a few more years at the time of writing. | - | [ 0 .. 9223372036854776000 ] | **required** |
| operand.updateTime.nanos | integer | There is no guarantee that all implementations support nanosecond precision. | - | [ 0 .. 999999999 ] | **required** |
| operand.location | - | XYZ coordinates | - | - | **additional properties are NOT allowed** |
| operand.location.x | number | - | - | - | **required** |
| operand.location.y | number | - | - | - | **required** |
| operand.location.z | number | - | - | - | **required** |
| operand.type | string | Type of reference point. | allowed (`"WIFI"`, `"BLE"`, `"LTE"`, `"UNKNOWN"`) | - | - |
| operand.wifiProperties | object | Only applicable when reference point type is WIFI. | - | - | **additional properties are NOT allowed** |
| operand.wifiProperties.online | boolean | - | - | - | - |
| operand.wifiProperties.locationStatus | string | - | allowed (`"NORMAL"`, `"ESTIMATED"`, `"WRONG"`) | - | - |
| operand.wifiProperties.ip | string | Unique. | - | format (`ipv4`) | - |
| operand.bleProperties | object | Only applicable when reference point type is BLE. | - | - | **additional properties are NOT allowed** |
| operand.bleProperties.active | boolean | - | - | - | - |
| operand.bleProperties.batteryPercentage | number | - | - | [ 0 .. 100 ] | - |
| operand.lteProperties | object | Only applicable when reference point type is LTE. | - | - | **additional properties are allowed** |
| operand.vendor | string | - | - | - | - |
| operand.vendorProperties | object | - | - | - | **additional properties are allowed** |

> Examples of payload _(generated)_

```json
{
  "timestamp": {
    "seconds": 1639658351,
    "nanos": 329000000
  },
  "replyTo": "v1.reference-point.response.post.vtb.atlas-staging.cloud.epiroc.com",
  "correlationId": "48fb4cd3-2ef6-4479-bea1-7c92721b988c",
  "operand": {
    "uuid": "095be615-a8ad-4c33-8e9c-c7612fbf6c9f",
    "rpId": "aa:bb:cc:dd:ee:f1",
    "name": "string",
    "description": "string",
    "createTime": {
      "seconds": 1639658351,
      "nanos": 329000000
    },
    "updateTime": {
      "seconds": 1639658351,
      "nanos": 329000000
    },
    "location": {
      "x": 0,
      "y": 0,
      "z": 0
    },
    "type": "WIFI",
    "wifiProperties": {
      "online": true,
      "locationStatus": "NORMAL",
      "ip": "192.168.0.1"
    },
    "bleProperties": {
      "active": true,
      "batteryPercentage": 100
    },
    "lteProperties": {},
    "vendor": "string",
    "vendorProperties": {}
  }
}
```



### SUB `v1.reference-point.cmd.put` Operation

* Operation ID: `referencePointPutCmdOperation`

Topic for requesting to completely update a reference point. All type-appropriate reference point fields are relevant.

#### `amqp` Channel specific information

| Name | Type | Description | Value | Constraints | Notes |
|---|---|---|---|---|---|
| is | - | - | `"routingKey"` | - | - |
| queue | - | - | - | - | - |
| queue.name | - | - | `"v1.reference-point.cmd.put"` | - | - |
| queue.durable | - | - | `"true"` | - | - |
| queue.exclusive | - | - | `"false"` | - | - |
| queue.autoDelete | - | - | `"false"` | - | - |
| exchange | - | - | - | - | - |
| exchange.name | - | - | `"amq.topic"` | - | - |
| exchange.type | - | - | `"topic"` | - | - |
| exchange.durable | - | - | `"true"` | - | - |
| exchange.autoDelete | - | - | `"false"` | - | - |
| exchange.vhost | - | - | `"/"` | - | - |
| bindingVersion | - | - | `"0.2.0"` | - | - |

#### `mqtt` Operation specific information

| Name | Type | Description | Value | Constraints | Notes |
|---|---|---|---|---|---|
| qos | - | - | `"2"` | - | - |
| retain | - | - | `"false"` | - | - |
| bindingVersion | - | - | `"0.1.0"` | - | - |
| note | - | - | `"When using MQTT with the RabbitMQ broker, the dots in the topic (which separate the levels in AMQP) should be replaced by slashes. E.g. a client using MQTT should publish to v1/reference-point/cmd/post instead of v1.reference-point.cmd.post and subscribe to v1/reference-point/event/update instead of v1.reference-point.event.update. The MQTT plugin for RabbitMQ translates the MQTT format to the AMQP format and vice versa."` | - | - |

#### Message `ReferencePointModifyCmd`

* Content type: [application/json](https://www.iana.org/assignments/media-types/application/json)

##### Payload

| Name | Type | Description | Value | Constraints | Notes |
|---|---|---|---|---|---|
| (root) | - | Request to make changes to a reference point. | - | - | **additional properties are allowed** |
| timestamp | object | Seconds and nanoseconds at UTC since 1970-01-01 00:00:00. | - | - | **required**, **additional properties are NOT allowed** |
| timestamp.seconds | integer | Unix timestamp, which is the number of seconds at UTC since 1970-01-01 00:00:00. Although some implementations may use 32-bit integers to represent this, it is highly recommended that you use a 64-bit integer, since 32 bits will only last for a few more years at the time of writing. | - | [ 0 .. 9223372036854776000 ] | **required** |
| timestamp.nanos | integer | There is no guarantee that all implementations support nanosecond precision. | - | [ 0 .. 999999999 ] | **required** |
| replyTo | string | The topic the result will be published to. | - | - | **required** |
| correlationId | string | ID that will be used in the response to a request to alleviate matching responses to requests on the client side. | - | format (`uuid`) | **required** |
| operand | object | Contains the state of an RP. Not all fields are necessary for all operations. | - | - | **required**, **additional properties are NOT allowed** |
| operand.uuid | string | Unique and immutable. | - | format (`uuid`) | - |
| operand.rpId | string | MAC address or other ID of a device. MACs are formatted as aa:bb.cc:dd:ee:f1. Unique. | - | - | - |
| operand.name | string | - | - | - | - |
| operand.description | string | - | - | - | - |
| operand.createTime | object | Seconds and nanoseconds at UTC since 1970-01-01 00:00:00. | - | - | **additional properties are NOT allowed** |
| operand.createTime.seconds | integer | Unix timestamp, which is the number of seconds at UTC since 1970-01-01 00:00:00. Although some implementations may use 32-bit integers to represent this, it is highly recommended that you use a 64-bit integer, since 32 bits will only last for a few more years at the time of writing. | - | [ 0 .. 9223372036854776000 ] | **required** |
| operand.createTime.nanos | integer | There is no guarantee that all implementations support nanosecond precision. | - | [ 0 .. 999999999 ] | **required** |
| operand.updateTime | object | Seconds and nanoseconds at UTC since 1970-01-01 00:00:00. | - | - | **additional properties are NOT allowed** |
| operand.updateTime.seconds | integer | Unix timestamp, which is the number of seconds at UTC since 1970-01-01 00:00:00. Although some implementations may use 32-bit integers to represent this, it is highly recommended that you use a 64-bit integer, since 32 bits will only last for a few more years at the time of writing. | - | [ 0 .. 9223372036854776000 ] | **required** |
| operand.updateTime.nanos | integer | There is no guarantee that all implementations support nanosecond precision. | - | [ 0 .. 999999999 ] | **required** |
| operand.location | - | XYZ coordinates | - | - | **additional properties are NOT allowed** |
| operand.location.x | number | - | - | - | **required** |
| operand.location.y | number | - | - | - | **required** |
| operand.location.z | number | - | - | - | **required** |
| operand.type | string | Type of reference point. | allowed (`"WIFI"`, `"BLE"`, `"LTE"`, `"UNKNOWN"`) | - | - |
| operand.wifiProperties | object | Only applicable when reference point type is WIFI. | - | - | **additional properties are NOT allowed** |
| operand.wifiProperties.online | boolean | - | - | - | - |
| operand.wifiProperties.locationStatus | string | - | allowed (`"NORMAL"`, `"ESTIMATED"`, `"WRONG"`) | - | - |
| operand.wifiProperties.ip | string | Unique. | - | format (`ipv4`) | - |
| operand.bleProperties | object | Only applicable when reference point type is BLE. | - | - | **additional properties are NOT allowed** |
| operand.bleProperties.active | boolean | - | - | - | - |
| operand.bleProperties.batteryPercentage | number | - | - | [ 0 .. 100 ] | - |
| operand.lteProperties | object | Only applicable when reference point type is LTE. | - | - | **additional properties are allowed** |
| operand.vendor | string | - | - | - | - |
| operand.vendorProperties | object | - | - | - | **additional properties are allowed** |

> Examples of payload _(generated)_

```json
{
  "timestamp": {
    "seconds": 1639658351,
    "nanos": 329000000
  },
  "replyTo": "v1.reference-point.response.post.vtb.atlas-staging.cloud.epiroc.com",
  "correlationId": "48fb4cd3-2ef6-4479-bea1-7c92721b988c",
  "operand": {
    "uuid": "095be615-a8ad-4c33-8e9c-c7612fbf6c9f",
    "rpId": "aa:bb:cc:dd:ee:f1",
    "name": "string",
    "description": "string",
    "createTime": {
      "seconds": 1639658351,
      "nanos": 329000000
    },
    "updateTime": {
      "seconds": 1639658351,
      "nanos": 329000000
    },
    "location": {
      "x": 0,
      "y": 0,
      "z": 0
    },
    "type": "WIFI",
    "wifiProperties": {
      "online": true,
      "locationStatus": "NORMAL",
      "ip": "192.168.0.1"
    },
    "bleProperties": {
      "active": true,
      "batteryPercentage": 100
    },
    "lteProperties": {},
    "vendor": "string",
    "vendorProperties": {}
  }
}
```



### SUB `v1.reference-point.cmd.patch` Operation

* Operation ID: `referencePointPatchCmdOperation`

Topic for requesting to partially update a reference point. Any reference point fields that should be modified should be specified, in addition to an unaltered uuid.

#### `amqp` Channel specific information

| Name | Type | Description | Value | Constraints | Notes |
|---|---|---|---|---|---|
| is | - | - | `"routingKey"` | - | - |
| queue | - | - | - | - | - |
| queue.name | - | - | `"v1.reference-point.cmd.patch"` | - | - |
| queue.durable | - | - | `"true"` | - | - |
| queue.exclusive | - | - | `"false"` | - | - |
| queue.autoDelete | - | - | `"false"` | - | - |
| exchange | - | - | - | - | - |
| exchange.name | - | - | `"amq.topic"` | - | - |
| exchange.type | - | - | `"topic"` | - | - |
| exchange.durable | - | - | `"true"` | - | - |
| exchange.autoDelete | - | - | `"false"` | - | - |
| exchange.vhost | - | - | `"/"` | - | - |
| bindingVersion | - | - | `"0.2.0"` | - | - |

#### `mqtt` Operation specific information

| Name | Type | Description | Value | Constraints | Notes |
|---|---|---|---|---|---|
| qos | - | - | `"2"` | - | - |
| retain | - | - | `"false"` | - | - |
| bindingVersion | - | - | `"0.1.0"` | - | - |
| note | - | - | `"When using MQTT with the RabbitMQ broker, the dots in the topic (which separate the levels in AMQP) should be replaced by slashes. E.g. a client using MQTT should publish to v1/reference-point/cmd/post instead of v1.reference-point.cmd.post and subscribe to v1/reference-point/event/update instead of v1.reference-point.event.update. The MQTT plugin for RabbitMQ translates the MQTT format to the AMQP format and vice versa."` | - | - |

#### Message `ReferencePointModifyCmd`

* Content type: [application/json](https://www.iana.org/assignments/media-types/application/json)

##### Payload

| Name | Type | Description | Value | Constraints | Notes |
|---|---|---|---|---|---|
| (root) | - | Request to make changes to a reference point. | - | - | **additional properties are allowed** |
| timestamp | object | Seconds and nanoseconds at UTC since 1970-01-01 00:00:00. | - | - | **required**, **additional properties are NOT allowed** |
| timestamp.seconds | integer | Unix timestamp, which is the number of seconds at UTC since 1970-01-01 00:00:00. Although some implementations may use 32-bit integers to represent this, it is highly recommended that you use a 64-bit integer, since 32 bits will only last for a few more years at the time of writing. | - | [ 0 .. 9223372036854776000 ] | **required** |
| timestamp.nanos | integer | There is no guarantee that all implementations support nanosecond precision. | - | [ 0 .. 999999999 ] | **required** |
| replyTo | string | The topic the result will be published to. | - | - | **required** |
| correlationId | string | ID that will be used in the response to a request to alleviate matching responses to requests on the client side. | - | format (`uuid`) | **required** |
| operand | object | Contains the state of an RP. Not all fields are necessary for all operations. | - | - | **required**, **additional properties are NOT allowed** |
| operand.uuid | string | Unique and immutable. | - | format (`uuid`) | - |
| operand.rpId | string | MAC address or other ID of a device. MACs are formatted as aa:bb.cc:dd:ee:f1. Unique. | - | - | - |
| operand.name | string | - | - | - | - |
| operand.description | string | - | - | - | - |
| operand.createTime | object | Seconds and nanoseconds at UTC since 1970-01-01 00:00:00. | - | - | **additional properties are NOT allowed** |
| operand.createTime.seconds | integer | Unix timestamp, which is the number of seconds at UTC since 1970-01-01 00:00:00. Although some implementations may use 32-bit integers to represent this, it is highly recommended that you use a 64-bit integer, since 32 bits will only last for a few more years at the time of writing. | - | [ 0 .. 9223372036854776000 ] | **required** |
| operand.createTime.nanos | integer | There is no guarantee that all implementations support nanosecond precision. | - | [ 0 .. 999999999 ] | **required** |
| operand.updateTime | object | Seconds and nanoseconds at UTC since 1970-01-01 00:00:00. | - | - | **additional properties are NOT allowed** |
| operand.updateTime.seconds | integer | Unix timestamp, which is the number of seconds at UTC since 1970-01-01 00:00:00. Although some implementations may use 32-bit integers to represent this, it is highly recommended that you use a 64-bit integer, since 32 bits will only last for a few more years at the time of writing. | - | [ 0 .. 9223372036854776000 ] | **required** |
| operand.updateTime.nanos | integer | There is no guarantee that all implementations support nanosecond precision. | - | [ 0 .. 999999999 ] | **required** |
| operand.location | - | XYZ coordinates | - | - | **additional properties are NOT allowed** |
| operand.location.x | number | - | - | - | **required** |
| operand.location.y | number | - | - | - | **required** |
| operand.location.z | number | - | - | - | **required** |
| operand.type | string | Type of reference point. | allowed (`"WIFI"`, `"BLE"`, `"LTE"`, `"UNKNOWN"`) | - | - |
| operand.wifiProperties | object | Only applicable when reference point type is WIFI. | - | - | **additional properties are NOT allowed** |
| operand.wifiProperties.online | boolean | - | - | - | - |
| operand.wifiProperties.locationStatus | string | - | allowed (`"NORMAL"`, `"ESTIMATED"`, `"WRONG"`) | - | - |
| operand.wifiProperties.ip | string | Unique. | - | format (`ipv4`) | - |
| operand.bleProperties | object | Only applicable when reference point type is BLE. | - | - | **additional properties are NOT allowed** |
| operand.bleProperties.active | boolean | - | - | - | - |
| operand.bleProperties.batteryPercentage | number | - | - | [ 0 .. 100 ] | - |
| operand.lteProperties | object | Only applicable when reference point type is LTE. | - | - | **additional properties are allowed** |
| operand.vendor | string | - | - | - | - |
| operand.vendorProperties | object | - | - | - | **additional properties are allowed** |

> Examples of payload _(generated)_

```json
{
  "timestamp": {
    "seconds": 1639658351,
    "nanos": 329000000
  },
  "replyTo": "v1.reference-point.response.post.vtb.atlas-staging.cloud.epiroc.com",
  "correlationId": "48fb4cd3-2ef6-4479-bea1-7c92721b988c",
  "operand": {
    "uuid": "095be615-a8ad-4c33-8e9c-c7612fbf6c9f",
    "rpId": "aa:bb:cc:dd:ee:f1",
    "name": "string",
    "description": "string",
    "createTime": {
      "seconds": 1639658351,
      "nanos": 329000000
    },
    "updateTime": {
      "seconds": 1639658351,
      "nanos": 329000000
    },
    "location": {
      "x": 0,
      "y": 0,
      "z": 0
    },
    "type": "WIFI",
    "wifiProperties": {
      "online": true,
      "locationStatus": "NORMAL",
      "ip": "192.168.0.1"
    },
    "bleProperties": {
      "active": true,
      "batteryPercentage": 100
    },
    "lteProperties": {},
    "vendor": "string",
    "vendorProperties": {}
  }
}
```



### SUB `v1.reference-point.cmd.delete` Operation

* Operation ID: `referencePointDeleteCmdOperation`

Topic for requesting to delete a reference point. Exactly one unique reference point field should be specified.

#### `amqp` Channel specific information

| Name | Type | Description | Value | Constraints | Notes |
|---|---|---|---|---|---|
| is | - | - | `"routingKey"` | - | - |
| queue | - | - | - | - | - |
| queue.name | - | - | `"v1.reference-point.cmd.delete"` | - | - |
| queue.durable | - | - | `"true"` | - | - |
| queue.exclusive | - | - | `"false"` | - | - |
| queue.autoDelete | - | - | `"false"` | - | - |
| exchange | - | - | - | - | - |
| exchange.name | - | - | `"amq.topic"` | - | - |
| exchange.type | - | - | `"topic"` | - | - |
| exchange.durable | - | - | `"true"` | - | - |
| exchange.autoDelete | - | - | `"false"` | - | - |
| exchange.vhost | - | - | `"/"` | - | - |
| bindingVersion | - | - | `"0.2.0"` | - | - |

#### `mqtt` Operation specific information

| Name | Type | Description | Value | Constraints | Notes |
|---|---|---|---|---|---|
| qos | - | - | `"2"` | - | - |
| retain | - | - | `"false"` | - | - |
| bindingVersion | - | - | `"0.1.0"` | - | - |
| note | - | - | `"When using MQTT with the RabbitMQ broker, the dots in the topic (which separate the levels in AMQP) should be replaced by slashes. E.g. a client using MQTT should publish to v1/reference-point/cmd/post instead of v1.reference-point.cmd.post and subscribe to v1/reference-point/event/update instead of v1.reference-point.event.update. The MQTT plugin for RabbitMQ translates the MQTT format to the AMQP format and vice versa."` | - | - |

#### Message `ReferencePointModifyCmd`

* Content type: [application/json](https://www.iana.org/assignments/media-types/application/json)

##### Payload

| Name | Type | Description | Value | Constraints | Notes |
|---|---|---|---|---|---|
| (root) | - | Request to make changes to a reference point. | - | - | **additional properties are allowed** |
| timestamp | object | Seconds and nanoseconds at UTC since 1970-01-01 00:00:00. | - | - | **required**, **additional properties are NOT allowed** |
| timestamp.seconds | integer | Unix timestamp, which is the number of seconds at UTC since 1970-01-01 00:00:00. Although some implementations may use 32-bit integers to represent this, it is highly recommended that you use a 64-bit integer, since 32 bits will only last for a few more years at the time of writing. | - | [ 0 .. 9223372036854776000 ] | **required** |
| timestamp.nanos | integer | There is no guarantee that all implementations support nanosecond precision. | - | [ 0 .. 999999999 ] | **required** |
| replyTo | string | The topic the result will be published to. | - | - | **required** |
| correlationId | string | ID that will be used in the response to a request to alleviate matching responses to requests on the client side. | - | format (`uuid`) | **required** |
| operand | object | Contains the state of an RP. Not all fields are necessary for all operations. | - | - | **required**, **additional properties are NOT allowed** |
| operand.uuid | string | Unique and immutable. | - | format (`uuid`) | - |
| operand.rpId | string | MAC address or other ID of a device. MACs are formatted as aa:bb.cc:dd:ee:f1. Unique. | - | - | - |
| operand.name | string | - | - | - | - |
| operand.description | string | - | - | - | - |
| operand.createTime | object | Seconds and nanoseconds at UTC since 1970-01-01 00:00:00. | - | - | **additional properties are NOT allowed** |
| operand.createTime.seconds | integer | Unix timestamp, which is the number of seconds at UTC since 1970-01-01 00:00:00. Although some implementations may use 32-bit integers to represent this, it is highly recommended that you use a 64-bit integer, since 32 bits will only last for a few more years at the time of writing. | - | [ 0 .. 9223372036854776000 ] | **required** |
| operand.createTime.nanos | integer | There is no guarantee that all implementations support nanosecond precision. | - | [ 0 .. 999999999 ] | **required** |
| operand.updateTime | object | Seconds and nanoseconds at UTC since 1970-01-01 00:00:00. | - | - | **additional properties are NOT allowed** |
| operand.updateTime.seconds | integer | Unix timestamp, which is the number of seconds at UTC since 1970-01-01 00:00:00. Although some implementations may use 32-bit integers to represent this, it is highly recommended that you use a 64-bit integer, since 32 bits will only last for a few more years at the time of writing. | - | [ 0 .. 9223372036854776000 ] | **required** |
| operand.updateTime.nanos | integer | There is no guarantee that all implementations support nanosecond precision. | - | [ 0 .. 999999999 ] | **required** |
| operand.location | - | XYZ coordinates | - | - | **additional properties are NOT allowed** |
| operand.location.x | number | - | - | - | **required** |
| operand.location.y | number | - | - | - | **required** |
| operand.location.z | number | - | - | - | **required** |
| operand.type | string | Type of reference point. | allowed (`"WIFI"`, `"BLE"`, `"LTE"`, `"UNKNOWN"`) | - | - |
| operand.wifiProperties | object | Only applicable when reference point type is WIFI. | - | - | **additional properties are NOT allowed** |
| operand.wifiProperties.online | boolean | - | - | - | - |
| operand.wifiProperties.locationStatus | string | - | allowed (`"NORMAL"`, `"ESTIMATED"`, `"WRONG"`) | - | - |
| operand.wifiProperties.ip | string | Unique. | - | format (`ipv4`) | - |
| operand.bleProperties | object | Only applicable when reference point type is BLE. | - | - | **additional properties are NOT allowed** |
| operand.bleProperties.active | boolean | - | - | - | - |
| operand.bleProperties.batteryPercentage | number | - | - | [ 0 .. 100 ] | - |
| operand.lteProperties | object | Only applicable when reference point type is LTE. | - | - | **additional properties are allowed** |
| operand.vendor | string | - | - | - | - |
| operand.vendorProperties | object | - | - | - | **additional properties are allowed** |

> Examples of payload _(generated)_

```json
{
  "timestamp": {
    "seconds": 1639658351,
    "nanos": 329000000
  },
  "replyTo": "v1.reference-point.response.post.vtb.atlas-staging.cloud.epiroc.com",
  "correlationId": "48fb4cd3-2ef6-4479-bea1-7c92721b988c",
  "operand": {
    "uuid": "095be615-a8ad-4c33-8e9c-c7612fbf6c9f",
    "rpId": "aa:bb:cc:dd:ee:f1",
    "name": "string",
    "description": "string",
    "createTime": {
      "seconds": 1639658351,
      "nanos": 329000000
    },
    "updateTime": {
      "seconds": 1639658351,
      "nanos": 329000000
    },
    "location": {
      "x": 0,
      "y": 0,
      "z": 0
    },
    "type": "WIFI",
    "wifiProperties": {
      "online": true,
      "locationStatus": "NORMAL",
      "ip": "192.168.0.1"
    },
    "bleProperties": {
      "active": true,
      "batteryPercentage": 100
    },
    "lteProperties": {},
    "vendor": "string",
    "vendorProperties": {}
  }
}
```



### SUB `v1.reference-point.cmd.snapshot` Operation

* Operation ID: `referencePointSnapshotCmdOperation`

Topic for requesting a reference point snapshot to be published to some topic. Note that the snapshot can be filtered by type and RP ID.

#### `amqp` Channel specific information

| Name | Type | Description | Value | Constraints | Notes |
|---|---|---|---|---|---|
| is | - | - | `"routingKey"` | - | - |
| queue | - | - | - | - | - |
| queue.name | - | - | `"v1.reference-point.cmd.snapshot"` | - | - |
| queue.durable | - | - | `"true"` | - | - |
| queue.exclusive | - | - | `"false"` | - | - |
| queue.autoDelete | - | - | `"false"` | - | - |
| exchange | - | - | - | - | - |
| exchange.name | - | - | `"amq.topic"` | - | - |
| exchange.type | - | - | `"topic"` | - | - |
| exchange.durable | - | - | `"true"` | - | - |
| exchange.autoDelete | - | - | `"false"` | - | - |
| exchange.vhost | - | - | `"/"` | - | - |
| bindingVersion | - | - | `"0.2.0"` | - | - |

#### `mqtt` Operation specific information

| Name | Type | Description | Value | Constraints | Notes |
|---|---|---|---|---|---|
| qos | - | - | `"2"` | - | - |
| retain | - | - | `"false"` | - | - |
| bindingVersion | - | - | `"0.1.0"` | - | - |
| note | - | - | `"When using MQTT with the RabbitMQ broker, the dots in the topic (which separate the levels in AMQP) should be replaced by slashes. E.g. a client using MQTT should publish to v1/reference-point/cmd/post instead of v1.reference-point.cmd.post and subscribe to v1/reference-point/event/update instead of v1.reference-point.event.update. The MQTT plugin for RabbitMQ translates the MQTT format to the AMQP format and vice versa."` | - | - |

#### Message `ReferencePointSnapshotCmd`

* Content type: [application/json](https://www.iana.org/assignments/media-types/application/json)

##### Payload

| Name | Type | Description | Value | Constraints | Notes |
|---|---|---|---|---|---|
| (root) | - | Request to publish a snapshot. | - | - | **additional properties are allowed** |
| replyTo | string | The topic the result will be published to. | - | - | **required** |
| correlationId | string | ID that will be present in the corresponding update event published by the provider. | - | format (`uuid`) | **required** |
| type | string | Type of reference point. | allowed (`"WIFI"`, `"BLE"`, `"LTE"`, `"UNKNOWN"`) | - | - |
| prefix | string | Filter by RP ID prefix. Note that this requires more complex cache logic on the client side, since the RP ID is mutable. | - | - | - |
| timestamp | object | Seconds and nanoseconds at UTC since 1970-01-01 00:00:00. | - | - | **required**, **additional properties are NOT allowed** |
| timestamp.seconds | integer | Unix timestamp, which is the number of seconds at UTC since 1970-01-01 00:00:00. Although some implementations may use 32-bit integers to represent this, it is highly recommended that you use a 64-bit integer, since 32 bits will only last for a few more years at the time of writing. | - | [ 0 .. 9223372036854776000 ] | **required** |
| timestamp.nanos | integer | There is no guarantee that all implementations support nanosecond precision. | - | [ 0 .. 999999999 ] | **required** |

> Examples of payload _(generated)_

```json
{
  "replyTo": "v1.reference-point.response.snapshot.vtb.atlas-staging.cloud.epiroc.com",
  "correlationId": "48fb4cd3-2ef6-4479-bea1-7c92721b988c",
  "type": "WIFI",
  "prefix": "aa:bb:cc",
  "timestamp": {
    "seconds": 1639658351,
    "nanos": 329000000
  }
}
```



### PUB `v1.reference-point.event.update` Operation

* Operation ID: `referencePointUpdateEventOperation`

Topic to which reference point update events are published. Queues bound to this should be durable and have a HA policy. Note that the message payload is the same for snapshot. See explanation and suggestions under the suggested snapshot response topic.

#### `amqp` Channel specific information

| Name | Type | Description | Value | Constraints | Notes |
|---|---|---|---|---|---|
| is | - | - | `"routingKey"` | - | - |
| queue | - | - | - | - | - |
| queue.name | - | - | `"v1.reference-point.event.update"` | - | - |
| queue.durable | - | - | `"true"` | - | - |
| queue.exclusive | - | - | `"false"` | - | - |
| queue.autoDelete | - | - | `"false"` | - | - |
| exchange | - | - | - | - | - |
| exchange.name | - | - | `"amq.topic"` | - | - |
| exchange.type | - | - | `"topic"` | - | - |
| exchange.durable | - | - | `"true"` | - | - |
| exchange.autoDelete | - | - | `"false"` | - | - |
| exchange.vhost | - | - | `"/"` | - | - |
| bindingVersion | - | - | `"0.2.0"` | - | - |

#### `mqtt` Operation specific information

| Name | Type | Description | Value | Constraints | Notes |
|---|---|---|---|---|---|
| qos | - | - | `"2"` | - | - |
| retain | - | - | `"false"` | - | - |
| bindingVersion | - | - | `"0.1.0"` | - | - |
| note | - | - | `"When using MQTT with the RabbitMQ broker, the dots in the topic (which separate the levels in AMQP) should be replaced by slashes. E.g. a client using MQTT should publish to v1/reference-point/cmd/post instead of v1.reference-point.cmd.post and subscribe to v1/reference-point/event/update instead of v1.reference-point.event.update. The MQTT plugin for RabbitMQ translates the MQTT format to the AMQP format and vice versa."` | - | - |

#### Message `ReferencePointUpdateEvent`

* Content type: [application/json](https://www.iana.org/assignments/media-types/application/json)

##### Payload

| Name | Type | Description | Value | Constraints | Notes |
|---|---|---|---|---|---|
| (root) | - | RP event. | - | - | **additional properties are allowed** |
| timestamp | object | Seconds and nanoseconds at UTC since 1970-01-01 00:00:00. | - | - | **required**, **additional properties are NOT allowed** |
| timestamp.seconds | integer | Unix timestamp, which is the number of seconds at UTC since 1970-01-01 00:00:00. Although some implementations may use 32-bit integers to represent this, it is highly recommended that you use a 64-bit integer, since 32 bits will only last for a few more years at the time of writing. | - | [ 0 .. 9223372036854776000 ] | **required** |
| timestamp.nanos | integer | There is no guarantee that all implementations support nanosecond precision. | - | [ 0 .. 999999999 ] | **required** |
| correlationId | string | ID that will be used in the response to a request to alleviate matching responses to requests on the client side. | - | format (`uuid`) | **required** |
| operation | string | REST-like operation type. | allowed (`"POST"`, `"PUT"`, `"PATCH"`, `"DELETE"`) | - | **required** |
| operands | array<object> | Array of reference points. | - | - | **required** |
| operands.uuid | string | Unique and immutable. | - | format (`uuid`) | - |
| operands.rpId | string | MAC address or other ID of a device. MACs are formatted as aa:bb.cc:dd:ee:f1. Unique. | - | - | - |
| operands.name | string | - | - | - | - |
| operands.description | string | - | - | - | - |
| operands.createTime | object | Seconds and nanoseconds at UTC since 1970-01-01 00:00:00. | - | - | **additional properties are NOT allowed** |
| operands.createTime.seconds | integer | Unix timestamp, which is the number of seconds at UTC since 1970-01-01 00:00:00. Although some implementations may use 32-bit integers to represent this, it is highly recommended that you use a 64-bit integer, since 32 bits will only last for a few more years at the time of writing. | - | [ 0 .. 9223372036854776000 ] | **required** |
| operands.createTime.nanos | integer | There is no guarantee that all implementations support nanosecond precision. | - | [ 0 .. 999999999 ] | **required** |
| operands.updateTime | object | Seconds and nanoseconds at UTC since 1970-01-01 00:00:00. | - | - | **additional properties are NOT allowed** |
| operands.updateTime.seconds | integer | Unix timestamp, which is the number of seconds at UTC since 1970-01-01 00:00:00. Although some implementations may use 32-bit integers to represent this, it is highly recommended that you use a 64-bit integer, since 32 bits will only last for a few more years at the time of writing. | - | [ 0 .. 9223372036854776000 ] | **required** |
| operands.updateTime.nanos | integer | There is no guarantee that all implementations support nanosecond precision. | - | [ 0 .. 999999999 ] | **required** |
| operands.location | - | XYZ coordinates | - | - | **additional properties are NOT allowed** |
| operands.location.x | number | - | - | - | **required** |
| operands.location.y | number | - | - | - | **required** |
| operands.location.z | number | - | - | - | **required** |
| operands.type | string | Type of reference point. | allowed (`"WIFI"`, `"BLE"`, `"LTE"`, `"UNKNOWN"`) | - | - |
| operands.wifiProperties | object | Only applicable when reference point type is WIFI. | - | - | **additional properties are NOT allowed** |
| operands.wifiProperties.online | boolean | - | - | - | - |
| operands.wifiProperties.locationStatus | string | - | allowed (`"NORMAL"`, `"ESTIMATED"`, `"WRONG"`) | - | - |
| operands.wifiProperties.ip | string | Unique. | - | format (`ipv4`) | - |
| operands.bleProperties | object | Only applicable when reference point type is BLE. | - | - | **additional properties are NOT allowed** |
| operands.bleProperties.active | boolean | - | - | - | - |
| operands.bleProperties.batteryPercentage | number | - | - | [ 0 .. 100 ] | - |
| operands.lteProperties | object | Only applicable when reference point type is LTE. | - | - | **additional properties are allowed** |
| operands.vendor | string | - | - | - | - |
| operands.vendorProperties | object | - | - | - | **additional properties are allowed** |
| error | object | Indication of an error. | - | - | **additional properties are NOT allowed** |
| error.code | integer | Code that indicates an error in an attempted operation. Only error HTTP codes are used. In the case of an internal error (500-range), the provider logs should be investigated. | - | - | **required** |
| error.message | string | Message that describes any error that may have arisen. It should pertain to the error code. This message should not contain stack traces or errors internal to the RP provider, to reduce the risk of divulging information about vulnerabilities in said application. If the error is of such a nature that the resulting payload would be inaccurate, the payload (or other corresponding field) should be undefined, except in cases where the payload would be incomplete. This is to ensure at least partial functionality in case of an error. | - | - | - |

> Examples of payload _(generated)_

```json
{
  "timestamp": {
    "seconds": 1639658351,
    "nanos": 329000000
  },
  "correlationId": "48fb4cd3-2ef6-4479-bea1-7c92721b988c",
  "operation": "POST",
  "operands": [
    {
      "uuid": "095be615-a8ad-4c33-8e9c-c7612fbf6c9f",
      "rpId": "aa:bb:cc:dd:ee:f1",
      "name": "string",
      "description": "string",
      "createTime": {
        "seconds": 1639658351,
        "nanos": 329000000
      },
      "updateTime": {
        "seconds": 1639658351,
        "nanos": 329000000
      },
      "location": {
        "x": 0,
        "y": 0,
        "z": 0
      },
      "type": "WIFI",
      "wifiProperties": {
        "online": true,
        "locationStatus": "NORMAL",
        "ip": "192.168.0.1"
      },
      "bleProperties": {
        "active": true,
        "batteryPercentage": 100
      },
      "lteProperties": {},
      "vendor": "string",
      "vendorProperties": {}
    }
  ],
  "error": {
    "code": 0,
    "message": "string"
  }
}
```



### PUB `v1.reference-point.response.operation.service.domain` Operation

* Operation ID: `referencePointModifyResponseOperation`

Suggested topic to which the result of a reference point modification would be published. This can be used to acquire the UUID of a reference point after a POST operation, check the actual resulting reference point et.c. All operations should return the full resulting reference point, except DELETE, which of course returns the last known state of the reference point.

#### `amqp` Channel specific information

| Name | Type | Description | Value | Constraints | Notes |
|---|---|---|---|---|---|
| is | - | - | `"routingKey"` | - | - |
| queue | - | - | - | - | - |
| queue.name | - | - | `"v1.reference-point.response.operation.service.domain"` | - | - |
| queue.durable | - | - | `"true"` | - | - |
| queue.exclusive | - | - | `"false"` | - | - |
| queue.autoDelete | - | - | `"false"` | - | - |
| exchange | - | - | - | - | - |
| exchange.name | - | - | `"amq.topic"` | - | - |
| exchange.type | - | - | `"topic"` | - | - |
| exchange.durable | - | - | `"true"` | - | - |
| exchange.autoDelete | - | - | `"false"` | - | - |
| exchange.vhost | - | - | `"/"` | - | - |
| bindingVersion | - | - | `"0.2.0"` | - | - |

#### `mqtt` Operation specific information

| Name | Type | Description | Value | Constraints | Notes |
|---|---|---|---|---|---|
| qos | - | - | `"2"` | - | - |
| retain | - | - | `"false"` | - | - |
| bindingVersion | - | - | `"0.1.0"` | - | - |
| note | - | - | `"When using MQTT with the RabbitMQ broker, the dots in the topic (which separate the levels in AMQP) should be replaced by slashes. E.g. a client using MQTT should publish to v1/reference-point/cmd/post instead of v1.reference-point.cmd.post and subscribe to v1/reference-point/event/update instead of v1.reference-point.event.update. The MQTT plugin for RabbitMQ translates the MQTT format to the AMQP format and vice versa."` | - | - |

#### Message `ReferencePointModifyResponse`

* Content type: [application/json](https://www.iana.org/assignments/media-types/application/json)

##### Payload

| Name | Type | Description | Value | Constraints | Notes |
|---|---|---|---|---|---|
| (root) | object | Response to a request to make changes to a reference point. | - | - | **additional properties are NOT allowed** |
| timestamp | object | Seconds and nanoseconds at UTC since 1970-01-01 00:00:00. | - | - | **required**, **additional properties are NOT allowed** |
| timestamp.seconds | integer | Unix timestamp, which is the number of seconds at UTC since 1970-01-01 00:00:00. Although some implementations may use 32-bit integers to represent this, it is highly recommended that you use a 64-bit integer, since 32 bits will only last for a few more years at the time of writing. | - | [ 0 .. 9223372036854776000 ] | **required** |
| timestamp.nanos | integer | There is no guarantee that all implementations support nanosecond precision. | - | [ 0 .. 999999999 ] | **required** |
| correlationId | string | - | - | format (`uuid`) | **required** |
| result | object | Contains the state of an RP. Not all fields are necessary for all operations. | - | - | **additional properties are NOT allowed** |
| result.uuid | string | Unique and immutable. | - | format (`uuid`) | - |
| result.rpId | string | MAC address or other ID of a device. MACs are formatted as aa:bb.cc:dd:ee:f1. Unique. | - | - | - |
| result.name | string | - | - | - | - |
| result.description | string | - | - | - | - |
| result.createTime | object | Seconds and nanoseconds at UTC since 1970-01-01 00:00:00. | - | - | **additional properties are NOT allowed** |
| result.createTime.seconds | integer | Unix timestamp, which is the number of seconds at UTC since 1970-01-01 00:00:00. Although some implementations may use 32-bit integers to represent this, it is highly recommended that you use a 64-bit integer, since 32 bits will only last for a few more years at the time of writing. | - | [ 0 .. 9223372036854776000 ] | **required** |
| result.createTime.nanos | integer | There is no guarantee that all implementations support nanosecond precision. | - | [ 0 .. 999999999 ] | **required** |
| result.updateTime | object | Seconds and nanoseconds at UTC since 1970-01-01 00:00:00. | - | - | **additional properties are NOT allowed** |
| result.updateTime.seconds | integer | Unix timestamp, which is the number of seconds at UTC since 1970-01-01 00:00:00. Although some implementations may use 32-bit integers to represent this, it is highly recommended that you use a 64-bit integer, since 32 bits will only last for a few more years at the time of writing. | - | [ 0 .. 9223372036854776000 ] | **required** |
| result.updateTime.nanos | integer | There is no guarantee that all implementations support nanosecond precision. | - | [ 0 .. 999999999 ] | **required** |
| result.location | - | XYZ coordinates | - | - | **additional properties are NOT allowed** |
| result.location.x | number | - | - | - | **required** |
| result.location.y | number | - | - | - | **required** |
| result.location.z | number | - | - | - | **required** |
| result.type | string | Type of reference point. | allowed (`"WIFI"`, `"BLE"`, `"LTE"`, `"UNKNOWN"`) | - | - |
| result.wifiProperties | object | Only applicable when reference point type is WIFI. | - | - | **additional properties are NOT allowed** |
| result.wifiProperties.online | boolean | - | - | - | - |
| result.wifiProperties.locationStatus | string | - | allowed (`"NORMAL"`, `"ESTIMATED"`, `"WRONG"`) | - | - |
| result.wifiProperties.ip | string | Unique. | - | format (`ipv4`) | - |
| result.bleProperties | object | Only applicable when reference point type is BLE. | - | - | **additional properties are NOT allowed** |
| result.bleProperties.active | boolean | - | - | - | - |
| result.bleProperties.batteryPercentage | number | - | - | [ 0 .. 100 ] | - |
| result.lteProperties | object | Only applicable when reference point type is LTE. | - | - | **additional properties are allowed** |
| result.vendor | string | - | - | - | - |
| result.vendorProperties | object | - | - | - | **additional properties are allowed** |
| error | object | Indication of an error. | - | - | **additional properties are NOT allowed** |
| error.code | integer | Code that indicates an error in an attempted operation. Only error HTTP codes are used. In the case of an internal error (500-range), the provider logs should be investigated. | - | - | **required** |
| error.message | string | Message that describes any error that may have arisen. It should pertain to the error code. This message should not contain stack traces or errors internal to the RP provider, to reduce the risk of divulging information about vulnerabilities in said application. If the error is of such a nature that the resulting payload would be inaccurate, the payload (or other corresponding field) should be undefined, except in cases where the payload would be incomplete. This is to ensure at least partial functionality in case of an error. | - | - | - |

> Examples of payload _(generated)_

```json
{
  "timestamp": {
    "seconds": 1639658351,
    "nanos": 329000000
  },
  "correlationId": "48fb4cd3-2ef6-4479-bea1-7c92721b988c",
  "result": {
    "uuid": "095be615-a8ad-4c33-8e9c-c7612fbf6c9f",
    "rpId": "aa:bb:cc:dd:ee:f1",
    "name": "string",
    "description": "string",
    "createTime": {
      "seconds": 1639658351,
      "nanos": 329000000
    },
    "updateTime": {
      "seconds": 1639658351,
      "nanos": 329000000
    },
    "location": {
      "x": 0,
      "y": 0,
      "z": 0
    },
    "type": "WIFI",
    "wifiProperties": {
      "online": true,
      "locationStatus": "NORMAL",
      "ip": "192.168.0.1"
    },
    "bleProperties": {
      "active": true,
      "batteryPercentage": 100
    },
    "lteProperties": {},
    "vendor": "string",
    "vendorProperties": {}
  },
  "error": {
    "code": 0,
    "message": "string"
  }
}
```



### PUB `v1.reference-point.response.snapshot.service.domain` Operation

* Operation ID: `referencePointSnapshotResponseOperation`

Suggested topic to which a reference point snapshot would be published. The payload is the same as that of the update event. In order for a service to build a complete image of the reference point state and keep it up-to-date, it should start from a clean cache, subscribe to updates and save them internally, request a snapshot, receive the snapshot and apply it to the cache, discard all updates with an older timestamp than that of the snapshot and then apply the rest of the updates to the cache. Snapshots can be distinguished from updates by their correlation ID. (Updates don't have one, since they're not associated with any request.)

#### `amqp` Channel specific information

| Name | Type | Description | Value | Constraints | Notes |
|---|---|---|---|---|---|
| is | - | - | `"routingKey"` | - | - |
| queue | - | - | - | - | - |
| queue.name | - | - | `"v1.reference-point.response.snapshot.service.domain"` | - | - |
| queue.durable | - | - | `"true"` | - | - |
| queue.exclusive | - | - | `"false"` | - | - |
| queue.autoDelete | - | - | `"false"` | - | - |
| exchange | - | - | - | - | - |
| exchange.name | - | - | `"amq.topic"` | - | - |
| exchange.type | - | - | `"topic"` | - | - |
| exchange.durable | - | - | `"true"` | - | - |
| exchange.autoDelete | - | - | `"false"` | - | - |
| exchange.vhost | - | - | `"/"` | - | - |
| bindingVersion | - | - | `"0.2.0"` | - | - |

#### `mqtt` Operation specific information

| Name | Type | Description | Value | Constraints | Notes |
|---|---|---|---|---|---|
| qos | - | - | `"2"` | - | - |
| retain | - | - | `"false"` | - | - |
| bindingVersion | - | - | `"0.1.0"` | - | - |
| note | - | - | `"When using MQTT with the RabbitMQ broker, the dots in the topic (which separate the levels in AMQP) should be replaced by slashes. E.g. a client using MQTT should publish to v1/reference-point/cmd/post instead of v1.reference-point.cmd.post and subscribe to v1/reference-point/event/update instead of v1.reference-point.event.update. The MQTT plugin for RabbitMQ translates the MQTT format to the AMQP format and vice versa."` | - | - |

#### Message `ReferencePointUpdateEvent`

* Content type: [application/json](https://www.iana.org/assignments/media-types/application/json)

##### Payload

| Name | Type | Description | Value | Constraints | Notes |
|---|---|---|---|---|---|
| (root) | - | RP event. | - | - | **additional properties are allowed** |
| timestamp | object | Seconds and nanoseconds at UTC since 1970-01-01 00:00:00. | - | - | **required**, **additional properties are NOT allowed** |
| timestamp.seconds | integer | Unix timestamp, which is the number of seconds at UTC since 1970-01-01 00:00:00. Although some implementations may use 32-bit integers to represent this, it is highly recommended that you use a 64-bit integer, since 32 bits will only last for a few more years at the time of writing. | - | [ 0 .. 9223372036854776000 ] | **required** |
| timestamp.nanos | integer | There is no guarantee that all implementations support nanosecond precision. | - | [ 0 .. 999999999 ] | **required** |
| correlationId | string | ID that will be used in the response to a request to alleviate matching responses to requests on the client side. | - | format (`uuid`) | **required** |
| operation | string | REST-like operation type. | allowed (`"POST"`, `"PUT"`, `"PATCH"`, `"DELETE"`) | - | **required** |
| operands | array<object> | Array of reference points. | - | - | **required** |
| operands.uuid | string | Unique and immutable. | - | format (`uuid`) | - |
| operands.rpId | string | MAC address or other ID of a device. MACs are formatted as aa:bb.cc:dd:ee:f1. Unique. | - | - | - |
| operands.name | string | - | - | - | - |
| operands.description | string | - | - | - | - |
| operands.createTime | object | Seconds and nanoseconds at UTC since 1970-01-01 00:00:00. | - | - | **additional properties are NOT allowed** |
| operands.createTime.seconds | integer | Unix timestamp, which is the number of seconds at UTC since 1970-01-01 00:00:00. Although some implementations may use 32-bit integers to represent this, it is highly recommended that you use a 64-bit integer, since 32 bits will only last for a few more years at the time of writing. | - | [ 0 .. 9223372036854776000 ] | **required** |
| operands.createTime.nanos | integer | There is no guarantee that all implementations support nanosecond precision. | - | [ 0 .. 999999999 ] | **required** |
| operands.updateTime | object | Seconds and nanoseconds at UTC since 1970-01-01 00:00:00. | - | - | **additional properties are NOT allowed** |
| operands.updateTime.seconds | integer | Unix timestamp, which is the number of seconds at UTC since 1970-01-01 00:00:00. Although some implementations may use 32-bit integers to represent this, it is highly recommended that you use a 64-bit integer, since 32 bits will only last for a few more years at the time of writing. | - | [ 0 .. 9223372036854776000 ] | **required** |
| operands.updateTime.nanos | integer | There is no guarantee that all implementations support nanosecond precision. | - | [ 0 .. 999999999 ] | **required** |
| operands.location | - | XYZ coordinates | - | - | **additional properties are NOT allowed** |
| operands.location.x | number | - | - | - | **required** |
| operands.location.y | number | - | - | - | **required** |
| operands.location.z | number | - | - | - | **required** |
| operands.type | string | Type of reference point. | allowed (`"WIFI"`, `"BLE"`, `"LTE"`, `"UNKNOWN"`) | - | - |
| operands.wifiProperties | object | Only applicable when reference point type is WIFI. | - | - | **additional properties are NOT allowed** |
| operands.wifiProperties.online | boolean | - | - | - | - |
| operands.wifiProperties.locationStatus | string | - | allowed (`"NORMAL"`, `"ESTIMATED"`, `"WRONG"`) | - | - |
| operands.wifiProperties.ip | string | Unique. | - | format (`ipv4`) | - |
| operands.bleProperties | object | Only applicable when reference point type is BLE. | - | - | **additional properties are NOT allowed** |
| operands.bleProperties.active | boolean | - | - | - | - |
| operands.bleProperties.batteryPercentage | number | - | - | [ 0 .. 100 ] | - |
| operands.lteProperties | object | Only applicable when reference point type is LTE. | - | - | **additional properties are allowed** |
| operands.vendor | string | - | - | - | - |
| operands.vendorProperties | object | - | - | - | **additional properties are allowed** |
| error | object | Indication of an error. | - | - | **additional properties are NOT allowed** |
| error.code | integer | Code that indicates an error in an attempted operation. Only error HTTP codes are used. In the case of an internal error (500-range), the provider logs should be investigated. | - | - | **required** |
| error.message | string | Message that describes any error that may have arisen. It should pertain to the error code. This message should not contain stack traces or errors internal to the RP provider, to reduce the risk of divulging information about vulnerabilities in said application. If the error is of such a nature that the resulting payload would be inaccurate, the payload (or other corresponding field) should be undefined, except in cases where the payload would be incomplete. This is to ensure at least partial functionality in case of an error. | - | - | - |

> Examples of payload _(generated)_

```json
{
  "timestamp": {
    "seconds": 1639658351,
    "nanos": 329000000
  },
  "correlationId": "48fb4cd3-2ef6-4479-bea1-7c92721b988c",
  "operation": "POST",
  "operands": [
    {
      "uuid": "095be615-a8ad-4c33-8e9c-c7612fbf6c9f",
      "rpId": "aa:bb:cc:dd:ee:f1",
      "name": "string",
      "description": "string",
      "createTime": {
        "seconds": 1639658351,
        "nanos": 329000000
      },
      "updateTime": {
        "seconds": 1639658351,
        "nanos": 329000000
      },
      "location": {
        "x": 0,
        "y": 0,
        "z": 0
      },
      "type": "WIFI",
      "wifiProperties": {
        "online": true,
        "locationStatus": "NORMAL",
        "ip": "192.168.0.1"
      },
      "bleProperties": {
        "active": true,
        "batteryPercentage": 100
      },
      "lteProperties": {},
      "vendor": "string",
      "vendorProperties": {}
    }
  ],
  "error": {
    "code": 0,
    "message": "string"
  }
}
```



